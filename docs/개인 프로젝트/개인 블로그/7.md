---
layout: default
title: Jekyll ë¸”ë¡œê·¸ Github Action ì—°ê²°
has_children: false
published_date: 2023-06-27
last_modified_date: 2023-11-03
nav_order: 6
grand_parent: ê°œì¸ í”„ë¡œì íŠ¸
parent: ê°œì¸ ë¸”ë¡œê·¸
permalink: '7'
---
Github Actionì„ í†µí•´ ë¡œì»¬ í™˜ê²½ì—ì„œ êµ¬ì¶•í•œ ë¸”ë¡œê·¸ë¥¼ ë°°í¬í•´ë³´ê² ìŠµë‹ˆë‹¤.


ë°°í¬ ì „ GitHub í† í°ì„ ë°œê¸‰ ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.


## GitHub Token ë°œê¸‰


Github í˜ì´ì§€ì—ì„œ ìš°ì¸¡ ìƒë‹¨ ì•„ë°”íƒ€ â†’ Settings â†’ ì¢Œì¸¡ ë©”ë‰´ Developer settings â†’ Personal access tokensì—ì„œ ì•„ë˜ ê¶Œí•œì„ ê°–ëŠ” í† í°ì„ ìƒì„±í•©ë‹ˆë‹¤.

- repo
- workflow
- admin:repo_hook

ìƒì„±í•œ í† í°ì€ ì•ˆì „í•˜ê²Œ ë³´ê´€í•©ë‹ˆë‹¤.


ë‹¤ìŒìœ¼ë¡œ, ë°°í¬í•˜ê³ ì í•˜ëŠ” repository â†’ Settings â†’ ì¢Œì¸¡ ë©”ë‰´ ì¤‘ Secrets and variables â†’ Actionsì—ì„œ ì´ì „ì— ìƒì„±í•œ Notion ë°ì´í„°ë² ì´ìŠ¤ ì•„ì´ë””ì™€ Notion API í‚¤, AWS í‚¤ì™€ GitHub Tokenì„ ë“±ë¡í•©ë‹ˆë‹¤.


{% include lazyload.html image_src="https://devshjeon-blog-images.s3.ap-northeast-2.amazonaws.com/_images/%EA%B0%9C%EC%9D%B8%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8/%EA%B0%9C%EC%9D%B8%20%EB%B8%94%EB%A1%9C%EA%B7%B8/Jekyll%20%EB%B8%94%EB%A1%9C%EA%B7%B8%20Github%20Action%20%EC%97%B0%EA%B2%B0/1.webp" %}


## Github Action í”„ë¡œì„¸ìŠ¤


ë°°í¬ í”„ë¡œì„¸ìŠ¤ëŠ” 2ë‹¨ê³„ë¡œ ë¶„ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.

1. Notion í¬ìŠ¤íŠ¸ë¥¼ Markdown íŒŒì¼ë¡œ ìƒì„±í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ë° ìƒì„±ëœ íŒŒì¼ commit & push
2. Jekyll ë¹Œë“œ ë° Deploy

### 1ë‹¨ê³„ ìŠ¤í¬ë¦½íŠ¸


1ë‹¨ê³„ ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ìŒ í”„ë¡œì„¸ìŠ¤ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

1. [RUN_WORKFLOW_DISPATCH] ì´ë²¤íŠ¸ë¥¼ ë°›ì•„ ì‹¤í–‰
2. íŒŒì¼ ìƒì„± ìŠ¤í¬ë¦½íŠ¸ (notion-import.js) ì‹¤í–‰ í™˜ê²½ êµ¬ì„±
3. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
4. ìƒì„±ëœ íŒŒì¼ commit & push
5. [RUN_WORKFLOW_DISPATCH_NEXT] ì´ë²¤íŠ¸ ë°œìƒ

`.github/workflows/notion-sync.yml`


{% raw %}
```yaml
# This workflow uses actions that are not certified by GitHub.
# They are provided by a third-party and are governed by
# separate terms of service, privacy policy, and support
# documentation.

# Sample workflow for building and deploying a Jekyll site to GitHub Pages
name: Notion sync

on:
  repository_dispatch:
    types: [ RUN_WORKFLOW_DISPATCH ]

  # Allows you to run this workflow manually from the Actions tab
#  workflow_dispatch:

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: write
  pages: write
  id-token: write

# Allow one concurrent deployment
concurrency:
  group: "devshjeon-notion-sync"
  cancel-in-progress: true

jobs:
  importer:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Create file
        uses: actions/setup-node@v3
        with:
          node-version: "18"
      - run: npm install
      - run: node _scripts/notion-import.js
        env:
          NOTION_TOKEN: ${{ secrets.NOTION_TOKEN }}
          DATABASE_ID: ${{ secrets.DATABASE_ID }}
          AWS_ACCESS_KEY: ${{ secrets.AWS_ACCESS_KEY }}
          AWS_SECRET_KEY: ${{ secrets.AWS_SECRET_KEY }}

      - name: Commit and push changes
        uses: stefanzweifel/git-auto-commit-action@v4
        with:
          commit_message: Update Importer posts
          branch: local
          commit_user_name: importer-bot ğŸ¤–
          commit_user_email: devshjeon@gmail.com
          commit_author: importer-bot ğŸ¤– <devshjeon@github.com>

      - run: gh api /repos/devshjeon/devshjeon/dispatches -f event_type='RUN_WORKFLOW_DISPATCH_NEXT'
        env:
          GITHUB_TOKEN: ${{ secrets.GH_TOKEN }}
```
{% endraw %}


### 2ë‹¨ê³„ ìŠ¤í¬ë¦½íŠ¸


2ë‹¨ê³„ ìŠ¤í¬ë¦½íŠ¸ëŠ” ë‹¤ìŒ í”„ë¡œì„¸ìŠ¤ë¡œ ì‹¤í–‰ë©ë‹ˆë‹¤.

1. [RUN_WORKFLOW_DISPATCH_NEXT] ì´ë²¤íŠ¸ë¥¼ ë°›ì•„ ì‹¤í–‰
2. Jekyll ë¹Œë“œ
3. GitHub Pages Deploy

`.github/workflows/deploy.yml`


{% raw %}
```yaml
# This workflow uses actions that are not certified by GitHub.
# They are provided by a third-party and are governed by
# separate terms of service, privacy policy, and support
# documentation.

# Sample workflow for building and deploying a Jekyll site to GitHub Pages
name: Deploy Jekyll site to Pages

on:
  repository_dispatch:
    types: [ RUN_WORKFLOW_DISPATCH_NEXT ]

  # Allows you to run this workflow manually from the Actions tab
#  workflow_dispatch:

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

# Allow one concurrent deployment
concurrency:
  group: "devshjeon-deploy"
  cancel-in-progress: true

jobs:
  # Build job
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Ruby
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: "3.2"
          bundler-cache: true # runs 'bundle install' and caches installed gems automatically
          cache-version: 0 # Increment this number if you need to re-download cached gems

      - name: Setup Pages
        id: pages
        uses: actions/configure-pages@v3

      - name: Build with Jekyll
        run: bundle exec jekyll build --baseurl "${ { steps.pages.outputs.base_path } }"
        env:
          JEKYLL_ENV: production

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v2

  # Deployment job
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v2
```
{% endraw %}


## GitHub Action ì‹¤í–‰ ë²„íŠ¼ ìƒì„±


Notionì—ì„œ ê¸€ì„ ì‘ì„±í•˜ê³  GitHub Actionì„ ì‹¤í–‰ í•˜ê¸° ìœ„í•´, ë§í¬([https://www.notion-tools.com/embeds/html](https://www.notion-tools.com/embeds/html))ì—ì„œ HTML ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ ë²„íŠ¼ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


{% include lazyload.html image_src="https://devshjeon-blog-images.s3.ap-northeast-2.amazonaws.com/_images/%EA%B0%9C%EC%9D%B8%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8/%EA%B0%9C%EC%9D%B8%20%EB%B8%94%EB%A1%9C%EA%B7%B8/Jekyll%20%EB%B8%94%EB%A1%9C%EA%B7%B8%20Github%20Action%20%EC%97%B0%EA%B2%B0/2.webp" %}


{% raw %}
```html
<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    .trigger-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .trigger-button {
      display: inline-block;
      margin-bottom: 10px;
      padding: 10px 20px;
      background-color: #4c9aff;
      color: white;
      font-size: 16px;
      border: none;
      cursor: pointer;
      border-radius: 4px;
      box-shadow: 0px 2px 6px rgba(0, 0, 0, 0.1);
      transition: background-color 0.3s;
    }

    .trigger-button:hover {
      background-color: #2e86ff;
    }

    .message {
      font-size: 16px;
      color: #333;
    }
  </style>
</head>
<body>
  <div class="trigger-container">
    <button id="triggerButton" class="trigger-button">ê°±ì‹ </button>
    <div id="message" class="message"></div>
  </div>

  <script>
    document.getElementById("triggerButton").addEventListener("click", function() {
      var messageElement = document.getElementById("message");
      messageElement.textContent = "ìš”ì²­ ì „ì†¡ ì¤‘...";

      var xhr = new XMLHttpRequest();
      xhr.open("POST", "https://api.github.com/repos/**USERNAME/REPO_NAME**/dispatches", true);
      xhr.setRequestHeader("Accept", "application/vnd.github.v3+json");
      xhr.setRequestHeader("Authorization", "Bearer **GITHUB_ACCESS_TOKEN**");
      xhr.setRequestHeader("Content-Type", "application/json");
      xhr.onreadystatechange = function() {
        if (xhr.readyState === 4 && xhr.status === 204) {
          messageElement.textContent = "ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤.";
        }
      };
      xhr.send(JSON.stringify({"event_type": "RUN_WORKFLOW_DISPATCH"}));
    });
  </script>
</body>
</html>
```
{% endraw %}


ìƒì„±ëœ ë§í¬ë¥¼ ì„ë² ë“œ ê¸°ëŠ¥ì„ ì´ìš©í•˜ë©´ ë²„íŠ¼ì´ ìƒì„±ë˜ê³  ë²„íŠ¼ì„ í´ë¦­ ì‹œ, GitHub Actionì—ì„œ workflowê°€ ì‹¤í–‰ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


{% include lazyload.html image_src="https://devshjeon-blog-images.s3.ap-northeast-2.amazonaws.com/_images/%EA%B0%9C%EC%9D%B8%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8/%EA%B0%9C%EC%9D%B8%20%EB%B8%94%EB%A1%9C%EA%B7%B8/Jekyll%20%EB%B8%94%EB%A1%9C%EA%B7%B8%20Github%20Action%20%EC%97%B0%EA%B2%B0/3.webp" %}


## Reference


[https://lourcode.kr/posts/Jekyll-ê¸°ë°˜-Github-Pagesì™€-Notion-Page-ì—°ë™/](https://lourcode.kr/posts/Jekyll-%EA%B8%B0%EB%B0%98-Github-Pages%EC%99%80-Notion-Page-%EC%97%B0%EB%8F%99/)

